COPY INTO "<<DB_NAME>>"."<<SCHEMA_NAME>>"."RAW_RESULTS_STAGING" (S3FILENAME,MSO,FILE_NAME,PROJECT_NAME,AGGREGATE_DATE,DSL_PROVIDER,DSL_MAXSPEED,FIBER_PROVIDER,FIBER_MAXSPEED,FIBER_TV_PROVIDER,FIBER_PHONE_PROVIDER,DIRECT_TV_PROVIDER,DSL_CUSTOMER,FIBER_CUSTOMER,DSL_CUSTOMER_SPEED,FIBER_CUSTOMER_SPEED,DIRECT_TV_CUSTOMER,FIBER_TV_CUSTOMER,WIRELESS_CUSTOMER,POTS_CUSTOMER,GIGABYTE,HOUSEKEY,FLATTENED_ID,SERVICE_PROVIDER,STATUS_STD,NETWORKTECHNOLOGY,AVAILABILITY_STATUS,RESULT_TYPE,SPRESALEESTIMATEDAYS,NEXTUPDATEDATE,WIRECENTERCODE,UPLOADMAXSPEED,S5G,LTE,S5G_SPEED,S4G_SPEED,S5G_UPLOAD_SPEED,AGG_SERVICE_PROVIDER,RESULT_SOURCE,RESULT_FILENAME,RESULT_FILEDATE) FROM (SELECT metadata$filename,t.$1,t.$2,t.$3,t.$4,t.$5,t.$6,t.$7,t.$8,t.$9,t.$10,t.$11,t.$12,t.$13,t.$14,t.$15,t.$16,t.$17,t.$18,t.$19,t.$20,t.$21,t.$22,t.$23,t.$24,t.$25,t.$26,t.$27,t.$28,t.$29,t.$30,t.$31,t.$32,t.$33,t.$34,t.$35,t.$36,t.$37,'<<source>>','<<file_name>>','<<current_date>>' FROM  '@"SCIERA_SUBSYSTEM"."REALWATCH"."SIS_SKYCTEL"/<<file_path>>' t) FILE_FORMAT = (COMPRESSION = 'AUTO' FIELD_DELIMITER = '|',RECORD_DELIMITER = '\n',SKIP_HEADER = 1,FIELD_OPTIONALLY_ENCLOSED_BY = '\"',TRIM_SPACE = TRUE, ERROR_ON_COLUMN_COUNT_MISMATCH = TRUE, ESCAPE = 'NONE', ESCAPE_UNENCLOSED_FIELD = '\134', DATE_FORMAT = 'AUTO', TIMESTAMP_FORMAT = 'AUTO', NULL_IF = ('NULL'),encoding = 'iso-8859-1') ON_ERROR = 'CONTINUE' PURGE = FALSE;

UPDATE "<<DB_NAME>>"."<<SCHEMA_NAME>>"."RAW_RESULTS_STAGING"
SET 
MSO = UPPER(MSO),
FILE_NAME = UPPER(FILE_NAME),
PROJECT_NAME = UPPER(PROJECT_NAME),
AGGREGATE_DATE = UPPER(AGGREGATE_DATE),
DSL_PROVIDER = UPPER(DSL_PROVIDER),
DSL_MAXSPEED = UPPER(DSL_MAXSPEED),
FIBER_PROVIDER = UPPER(FIBER_PROVIDER),
FIBER_MAXSPEED = UPPER(FIBER_MAXSPEED),
FIBER_TV_PROVIDER = UPPER(FIBER_TV_PROVIDER),
FIBER_PHONE_PROVIDER = UPPER(FIBER_PHONE_PROVIDER),
DIRECT_TV_PROVIDER = UPPER(DIRECT_TV_PROVIDER),
DSL_CUSTOMER = UPPER(DSL_CUSTOMER),
FIBER_CUSTOMER = UPPER(FIBER_CUSTOMER),
DSL_CUSTOMER_SPEED = UPPER(DSL_CUSTOMER_SPEED),
FIBER_CUSTOMER_SPEED = UPPER(FIBER_CUSTOMER_SPEED),
DIRECT_TV_CUSTOMER = UPPER(DIRECT_TV_CUSTOMER),
FIBER_TV_CUSTOMER = UPPER(FIBER_TV_CUSTOMER),
WIRELESS_CUSTOMER = UPPER(WIRELESS_CUSTOMER),
POTS_CUSTOMER = UPPER(POTS_CUSTOMER),
GIGABYTE = UPPER(GIGABYTE),
HOUSEKEY = UPPER(HOUSEKEY),
FLATTENED_ID = UPPER(FLATTENED_ID),
SERVICE_PROVIDER = UPPER(SERVICE_PROVIDER),
STATUS_STD = UPPER(STATUS_STD),
NETWORKTECHNOLOGY = UPPER(NETWORKTECHNOLOGY),
AVAILABILITY_STATUS = UPPER(AVAILABILITY_STATUS),
RESULT_TYPE = UPPER(RESULT_TYPE),
SPRESALEESTIMATEDAYS = UPPER(SPRESALEESTIMATEDAYS),
NEXTUPDATEDATE = UPPER(NEXTUPDATEDATE),
WIRECENTERCODE = UPPER(WIRECENTERCODE),
UPLOADMAXSPEED = UPPER(UPLOADMAXSPEED),
S5G = UPPER(S5G),
LTE = UPPER(LTE),
S5G_SPEED = UPPER(S5G_SPEED),
S4G_SPEED = UPPER(S4G_SPEED),
S5G_UPLOAD_SPEED = UPPER(S5G_UPLOAD_SPEED),
AGG_SERVICE_PROVIDER = UPPER(AGG_SERVICE_PROVIDER),
SCHEDULE_DATE = UPPER(SCHEDULE_DATE),
INTERNETCUSTOMER = UPPER(INTERNETCUSTOMER),
INTERNETCUSTOMERSPEED = UPPER(INTERNETCUSTOMERSPEED),
PROVIDERTYPE = UPPER(PROVIDERTYPE),
CHECK_DATE = UPPER(CHECK_DATE),
MAX_SPEED = UPPER(MAX_SPEED),
FIBER_TV_PROVIDER_UPDATED = UPPER(FIBER_TV_PROVIDER_UPDATED),
STATUS_CHANGED = UPPER(STATUS_CHANGED),
MSO_CHANGED = UPPER(MSO_CHANGED),
CB = UPPER(CB),
ZIP5 = UPPER(ZIP5),
ZIP4 = UPPER(ZIP4),
RWID = UPPER(RWID),
SRWID = UPPER(SRWID),
CB_AVAILABILITY = UPPER(CB_AVAILABILITY),
RESULT_SOURCE = UPPER(RESULT_SOURCE),
RESULT_FILEDATE = UPPER(RESULT_FILEDATE),
IS_MOVED = UPPER(IS_MOVED)
WHERE IS_MOVED = 'N' AND  RESULT_FILENAME='<<file_name>>';